(function(a){a.fn.cavisor=function(c){var d=a.extend({number:true,title:true,arrows:true,controls:true,width:900},c);var e=0;var b=0;return a("img.visor").each(function(){if(!a(this).hasClass("single-image")){a(this).attr("id","visor_"+e+((a(this).attr("id")!=undefined)?"-"+a(this).attr("id"):""));
e++;}else{a(this).attr("id","single_visor_"+b+((a(this).attr("id")!=undefined)?"-"+a(this).attr("id"):""));b++;}a(this).click(function(){function j(C,t,B,A,v,w){function z(){a("body").css("overflow","visible");
a("#visor").remove();a(document).unbind("keyup");}function y(){var D=((!o)?10:30);a("#visor_border").animate({"margin-top":((a(window).height()-B-30-D-2)/2),height:(B+30+D+2),width:(t+2)},"","",function(){a("#visor_controls_top").css({"margin-top":((a(window).height()-B-30-D-2)/2),"margin-left":((a(window).width()-t-20-2)/2)+10}).show();
a("#visor_close").css({"margin-left":t+2-15});if(o){a("#visor_controls_bottom").css({"margin-top":((a(window).height()-B-30-D)/2)+B+30,"margin-left":((a(window).width()-t-20-2)/2)+10}).show();
}});a("#visor_content").height(B).width(t).html('<img src="'+C+'" width="'+t+'" height="'+B+'" class="visor_image" />').fadeIn(1500);if(m){a("#visor_next, #visor_prev").show();
}}function u(){if(B>a(window).height()-100){var E=a(window).height()-100;var D=(E*t)/B;}if(t>a(window).width()-100&&D>a(window).width()-100){var D=a(window).width()-100;
var E=(B*D)/t;}if(D!=null){t=D;}if(E!=null){B=E;}}function s(){var D=((!o)?10:30);a("#visor_border").animate({"margin-top":((a(window).height()-B-30-D-2)/2),"margin-left":((a(window).width()-t-20-2)/2),height:(B+30+D+2),width:(t+2)},100);
if(h){if(a("#visor_number").length){a("#visor_number").html((v+1)+" / "+(e));}else{a('<span id="visor_number">'+(v+1)+" / "+(e)+"</span>").insertAfter("#visor_close");
}}else{a("#visor_number").remove();}if(w.attr("title")!=undefined&&l){if(a("#visor_title").length){a("#visor_title").html(w.attr("title")).width(t);}else{a("#visor_controls_top").append('<p id="visor_title">'+w.attr("title")+"</p>");
}}else{a("#visor_title").empty();}if(o){if(a("#visor_goto").length){a("#visor_goto").attr("href","#"+w.attr("id"));}else{a("#visor").append('<div id="visor_controls_bottom"><a id="visor_goto" href="#'+w.attr("id")+'">Go to image in the document</a></div>');
}a("#visor_controls_bottom").css({"margin-top":((a(window).height()-B-30-D)/2)+B+30,"margin-left":((a(window).width()-t-20-2)/2)+10}).show();}else{a("#visor_controls_bottom").remove();
}a("#visor_controls_top").css({"margin-top":((a(window).height()-B-30-D-2)/2),"margin-left":((a(window).width()-t-20-2)/2)+10}).show();a("#visor_close").css({"margin-left":t+2-15});
if(m){if(v>=1){if(!a("#visor_prev").length){a("#visor_border").prepend('<div id="visor_prev" class="visor_'+(v-1)+'"><span></span></div>');a("#visor_prev").click(function(){if(a("#"+a(this).attr("class")).length>0){a("#"+a(this).attr("class")).trigger("click");
}else{a("img[id^="+a(this).attr("class")+"-]").trigger("click");}return false;});}a("#visor_prev").css({"margin-top":(((B+2)/2)-23.5+30)});a("#visor_prev").attr("class","visor_"+(v-1));
}else{a("#visor_prev").remove();a("#visor_prev").unbind("click");}if(v<e-1){if(!a("#visor_next").length){a("#visor_content").before('<div id="visor_next" class="visor_'+(v+1)+'"><span></span></div>');
a("#visor_next").click(function(){if(a("#"+a(this).attr("class")).length>0){a("#"+a(this).attr("class")).trigger("click");}else{a('img[id^="'+a(this).attr("class")+'-"]').trigger("click");
}return false;});}a("#visor_next").css({"margin-left":(t-28),"margin-top":(((B+2)/2)-23.5+30)});a("#visor_next").attr("class","visor_"+(v+1));}else{a("#visor_next").remove();
a("#visor_next").unbind("click");}}else{a("#visor_prev, #visor_next").remove();}a("#visor_content").height(B).width(t).html('<img src="'+C+'" width="'+t+'" height="'+B+'" />').fadeIn(1500);
}function x(){a("#visor").remove();a("div.video object").remove();a("body").css("overflow","hidden").append('<div id="visor"><div id="visor_controls_top"><span id="visor_close">&#10005;</span>'+((h)?'<span id="visor_number">'+(v+1)+" / "+(e)+"</span>":"")+((l&&w.attr("title")!=undefined)?'<p id="visor_title">'+w.attr("title")+"</p>":"")+'</div><div id="visor_border">'+((m)?((v>=1)?'<div id="visor_prev" class="visor_'+(v-1)+'"></div>':"")+((v<e-1)?'<div id="visor_next" class="visor_'+(v+1)+'"></div>':""):"")+'<div id="visor_content"></div></div>'+((o)?'<div id="visor_controls_bottom"><a id="visor_goto" href="#'+w.attr("id")+'">Go to image in the document</a></div>':"")+"</div>");
a("#visor").height(a(document).height());a("#visor_prev, #visor_next").css("margin-top",(((B+2)/2)-23.5+30));a("#visor_next").css("margin-left",t-28);a("#visor_content, #visor_prev, #visor_next").hide();
a("#visor_controls_top, #visor_controls_bottom").width(t+2).hide();a("#visor_border").width(t+20).css({"margin-top":((a(window).height()-a("#visor_border").height())/2),"margin-left":((a(window).width()-t-20-2)/2)});
a("#visor_prev, #visor_next").click(function(){if(a("#"+a(this).attr("class")).length>0){a("#"+a(this).attr("class")).trigger("click");}else{a('img[id^="'+a(this).attr("class")+'-"]').trigger("click");
}return false;});a(document).keyup(function(D){switch(D.keyCode){case 37:if(a("#"+a("#visor_prev").attr("class")).length>0){a("#"+a("#visor_prev").attr("class")).trigger("click");
}else{a('img[id^="'+a("#visor_prev").attr("class")+'-"]').trigger("click");}break;case 39:if(a("#"+a("#visor_next").attr("class")).length>0){a("#"+a("#visor_next").attr("class")).trigger("click");
}else{a('img[id^="'+a("#visor_next").attr("class")+'-"]').trigger("click");}break;}});y();}if(a(window).height()>250&&a(window).width()>250){u();if(!a("#visor").length){x();
}else{s();}a("#visor_close").click(function(){z();return false;});a("#visor_goto").click(function(){z();});a(document).keyup(function(D){if(D.keyCode==27||D.keyCode==18||D.keyCode==69||D.keyCode==16||D.keyCode==81){z();
}});}else{console.log("CAVISOR ERROR: resolution less than 250x250px");}}var n=(a(this).attr("data-original")!=undefined)?a(this).attr("data-original"):a(this).attr("src");
var k=parseInt((a(this).attr("width")!=undefined)?a(this).attr("width"):a(this).width());var g=parseInt((a(this).attr("height")!=undefined)?a(this).attr("height"):a(this).height());
var o=(!a(this).hasClass("no-controls"))?d.controls:false;var l=(!a(this).hasClass("no-title"))?d.title:false;var h=(!a(this).hasClass("no-number")&&!a(this).hasClass("single-image"))?d.number:false;
var m=(!a(this).hasClass("single-image"))?d.arrows:false;var q=(a(this).attr("id")!=undefined)?a(this).attr("id").split("-"):"";if(q.length>1){var f=parseInt(q[1].match(/[\d]+$/));
var p=(q.length>2)?parseInt(q[2].match(/[\d]+$/)):((g*f)/k);}else{var f=d.width;var p=Math.round((g*f)/k);}var i=(!a(this).hasClass("single-image"))?parseInt(q[0].match(/[\d]+$/)):0;
var r=(a(this).hasClass("same-image"))?n:n.substr(0,n.length-9)+"big."+n.split(".").pop();j(r,f,p,true,i,a(this));return false;});});};}(jQuery));